const express = require("express");
const router = express.Router();

const {
  createVulnerability,
  getSystemVulnerabilities,
  patchVulnerability,
} = require("../controllers/vulnerabilityController");

const { protect } = require("../middleware/authMiddleware");

// All routes protected
router.use(protect);

// Create vulnerability
router.post("/", createVulnerability);

// Get vulnerabilities for a specific system
router.get("/:systemId", getSystemVulnerabilities);

// Patch vulnerability
router.put("/patch/:id", patchVulnerability);

module.exports = router;